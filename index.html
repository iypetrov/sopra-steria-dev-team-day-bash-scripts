<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Practical Shell Scripting</title>
       	<link rel="icon" type="image/x-icon" href="small-logo.png"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/reveal.min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/css/theme/white.min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/xcode.min.css" />
    </head>
    <style>
        mark {
            background-color: #ececec; 
            color: #c6241d;              
            border-radius: 10px;     
        }
    </style
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h2>practical shell scripting</h2>
                </section>

                <section>
                    <h3>agenda for today</h3>
                    <ul>
                        <li>What are shell scripts and why they are useful?</li>
                        <li>Basic concepts and constructs</li>
                        <li>Shell scripts in practice</li>
                        <li>Live demo: baby-k8s</li>
                        <li>Q&A</li>
                        <li>Conclusion</li>
                    </ul>
                </section>

                <!-- What are shell scripts and why they are useful? -->
                <section>
                    <h2>what are shell scripts and why they are useful?</h2>
                </section>

                <!-- Basic concepts and constructs -->
                <section>
                    <h2>basic concepts and constructs</h2>
                </section>

                <!-- Shell scripts in practice -->
                <section>
                    <section>
                        <h2>shell scripts in practice</h2>
                    </section>
                    <section>
                        <p>for this section will use <mark>containers.csv</mark></p>
                    </section>
                    <section>
                        <h3>columns of the csv file</h3>
                        <ul>
                            <li>container_name</li>
                            <li>image_name</li>
                            <li>image_tag</li>
                            <li>team</li>
                            <li>port</li>
                            <li>cpu</li>
                            <li>memory_gb</li>
                        </ul>
                    </section>
                    <section>
                        <h3>how to remove the heading line?</h3>
                        <pre><code class="language-bash">
#!/bin/bash

cat containers.csv | tail -n +2
                        </code></pre>
                    </section>
                    <section>
                        <h3>how to get data only for the image names?</h3>
                        <pre><code class="language-bash">
#!/bin/bash

cat containers.csv | cut -d ',' -f 2
                        </code></pre>
                    </section>
                    <section>
                        <h3>how to get data only for the memory limits?</h3>
                        <pre><code class="language-bash">
#!/bin/bash

# Option 1 
cat containers.csv | cut -d ',' -f 7

# Option 2
cat containers.csv | rev | cut -d ',' -f 1 | rev
                        </code></pre>
                    </section>
                    <section>
                        <h3>how to sort data by cpus limits (descending)?</h3>
                        <pre><code class="language-bash">
#!/bin/bash

cat containers.csv | tail -n +2 | sort -n -r -t ',' -k 6
                        </code></pre>
                    </section>
                    <section>
                        <h3>how to sort data:</h3>
                        <ol>
                            <li>by memory limits (ascending)</li>
                            <li>by team name (descending)</li>
                        </ol>
                        <pre><code class="language-bash">
#!/bin/bash

cat containers.csv | \
    tail -n +2 | \
    sort -t ',' -k7,7n -k4,4r
                        </code></pre>
                    </section>
                    <section>
                        <h3>how to aggregate the data based on the image name?</h3>
                        <p>Desired format:</p>
                        <p>"number-of-image-occurences" "image-name"</p>
                        <pre><code class="language-bash">
#!/bin/bash

cat containers.csv | \
    tail -n +2 | \
    cut -d ',' -f 2 | \
    sort | \
    uniq -c
                        </code></pre>
                    </section>
                </section>


                <!-- baby-k8s -->
                <section>
                    <section>
                        <h2>baby-k8s</h2>
                    </section>
                    <section>
                        <h3>why would we want to build this?</h3>
                        <ul>
                            <li>Simple use case</li>
                            <li>Easy to implement & maintain</li>
                            <li>Very lightweight solution compared to Kubernetes, HasiCorp Nomad or even Docker Swarm</li>
                        </ul>
                    </section>
                    <section>
                        <h3>what do we want to achieve?</h3>
                        <ul>
                            <li>To have a configuration file, where we define our target state</li>
                            <li>Automatic lifecycle management of our containers</li>
                            <li>To receive notifications on our Discord channel, when there is some event</li>
                        </ul>
                    </section>
                    <section>
                        <h3>what will we do?</h3>
                        <ul>
                            <li>Will use <mark>containers.csv</mark> file to declare the target state</li>
                            <li>Will use <mark>discord-notification.sh</mark> script to send notifications</li>
                            <li>Extend the <mark>baby-k8s.sh</mark> script in order to achive our goal</li>
                        </ul>
                    </section>
                    <section>
                        <h3>real-world scenario</h3>
                        <ul>
                            <li>In my previous project, I was part of a team responsible for the management & communication with IoT devices</li>
                            <li>IoT devices are usually resource-constrained</li>
                            <li>We utilized similar scripts to manage containers on these devices</li>
                        </ul>
                    </section>
                    <section>
                        <h3>desired result</h3>
                        <img src="discord-notifications.png" alt="Discord notifications" style="width: 20rem; height: auto; border: none;" />
                    </section>
                </section>

                <!-- Q&A -->
                <section>
                    <h2>q&a</h2>
                </section>

                <!-- Conclusion -->
                <section>
                    <h3>conclusion</h3>
                    <p>Thank you for your attention! ❤️</p>
                </section>
            </div>
        </div>

        <footer style="position: fixed; bottom: 10px; left: 10px;">
            <img src="big-logo.svg" alt="Sopra Steria Logo" style="width: 18rem; height: auto;" />
        </footer>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.6.0/js/reveal.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
        <script>
            Reveal.initialize({
                controls: true,
                progress: true,
                slideNumber: false,
                history: true,
                center: true,
                transition: 'slide'
            });
            hljs.highlightAll();
        </script>
    </body>
</html>
